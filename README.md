# Лабораторная работа №2.

### Выполнил:
Ямалов Искандер, М8О-106БВ-25

## Введение
Данное консольное приложение реализует различные команды из консоли Linux/MacOs
(список команд с их описанием указан ниже).
Все операции логируются в файл `shell.log`.

## Структура проекта

 <pre>
    lab2/
    ├── src/                                  # Исходный код
    │   ├── __init__.py
    │   ├── main.py                           # Точка входа в приложение с CLI командами
    │   ├── errors.py                         # Собственные классы исключений
    │   ├── common/                           # Общие модули
    │   │   ├── __init__.py
    │   │   └── config.py                     # Конфигурация логирования
    │   └── services/                         # Бизнес-логика
    │       ├── __init__.py
    │       ├── base.py                       # Абстрактный базовый класс для сервиса
    │       └── luckyos_console.py            # Реализация всех команд консоли
    │
    ├── tests/                                # Unit тесты
    │   ├── __init__.py
    │   ├── conftest.py                       # Фикстуры для pytest
    │   ├── test_ls.py                        # Тесты для команды ls
    │   ├── test_cd.py                        # Тесты для команды cd
    │   ├── test_cat.py                       # Тесты для команды cat
    │   ├── test_cp.py                        # Тесты для команды cp
    │   ├── test_mv.py                        # Тесты для команды mv
    │   ├── test_rm.py                        # Тесты для команды rm
    │   ├── test_zip.py                       # Тесты для команд zip и unzip
    │   ├── test_tar.py                       # Тесты для команд tar и untar
    │   └── test_grep.py                      # Тесты для команды grep
    │
    ├── uv.lock                               # зависимости проекта
    ├── shell.log                             # Файл логов (создается автоматически)
    ├── .gitignore                            # git ignore файл
    ├── .pre-commit-config.yaml               # Средства автоматизации проверки кодстайла
    └── README.md                             # Описание проекта
</pre>

## Описание реализованных команд

### Базовые команды (Easy)

#### `ls` - Просмотр содержимого директории
- **Использование:** `ls [путь] [--long | -l]`
- **Описание:** Выводит содержимое директории. С опцией `-l` выводит расширенную информацию: права доступа, количество ссылок, размер в байтах, дату изменения и имя файла.

#### `cd` - Смена текущей директории
- **Использование:** `cd <путь>`
- **Описание:** Изменяет текущую рабочую директорию. Поддерживает специальные значения:
  - `..` - переход в родительскую директорию
  - `~` - переход в домашнюю директорию

#### `cat` - Вывод содержимого файла
- **Использование:** `cat <файл>`
- **Описание:** Выводит содержимое файла в стандартный вывод.
- **Пример:** `cat file.txt`

#### `cp` - Копирование файлов и директорий
- **Использование:** `cp <источник> <назначение> [--recursive | -r]`
- **Описание:** Копирует файл или директорию. С опцией `-r` выполняется рекурсивное копирование директорий.


#### `mv` - Перемещение и переименование
- **Использование:** `mv <источник> <назначение>`
- **Описание:** Перемещает или переименовывает файл/директорию.
- **Пример:**
  - `mv old.txt new.txt` - переименование файла
  - `mv file.txt /dest/` - перемещение файла

#### `rm` - Удаление файлов и директорий
- **Использование:** `rm <путь> [--recursive | -r]`
- **Описание:** Удаляет файл или директорию. С опцией `-r` удаляет директории рекурсивно. При удалении директории запрашивается подтверждение. Запрещено удаление корневой директории (`/`) и родительской директории.
- **Пример:**
  - `rm file.txt` - удаление файла
  - `rm -r dir/` - удаление директории (с подтверждением)

#### `zip` - Создание ZIP архива
- **Использование:** `zip <директория> <архив.zip>`
- **Описание:** Создает ZIP архив из указанной директории.

#### `unzip` - Распаковка ZIP архива
- **Использование:** `unzip <архив.zip>`
- **Описание:** Распаковывает ZIP архив в текущую директорию.

#### `tar` - Создание TAR.GZ архива
- **Использование:** `tar <директория> <архив.tar.gz>`
- **Описание:** Создает TAR.GZ архив из указанной директории.

#### `untar` - Распаковка TAR.GZ архива
- **Использование:** `untar <архив.tar.gz>`
- **Описание:** Распаковывает TAR.GZ архив в текущую директорию.

#### `grep` - Поиск по регулярному выражению
- **Использование:** `grep <паттерн> <путь> [-r] [-i | --ignore-case]`
- **Описание:** Ищет совпадения регулярного выражения в файлах.
С опцией `-r` выполняет рекурсивный поиск в директории, с опцией `-i` игнорирует регистр.
- **Пример:**
  - `grep "pattern" file.txt` - поиск в файле
  - `grep -r "pattern" dir/` - рекурсивный поиск в директории
  - `grep -i "pattern" file.txt` - поиск без учета регистра

## Логирование
Все команды и ошибки логируются в файл `shell.log` и при превышении максимального размера все логи очищаются:
- Максимальный размер файла: 5 МБ
- Формат логов: `%(asctime)s [%(levelname)s] %(name)s: %(message)s`

### Примеры использования программы:
```bash
python -m src.main ls
python -m src.main ls --long
python -m src.main cd /path/to/dir
python -m src.main cat file.txt
python -m src.main cp -r source/ dest/
python -m src.main mv old.txt new.txt
python -m src.main rm -r dir/
python -m src.main zip folder/ archive.zip
python -m src.main unzip archive.zip
python -m src.main tar folder/ archive.tar.gz
python -m src.main untar archive.tar.gz
python -m src.main grep "pattern" -r -i file.txt
```

### Помощь по командам
Для просмотра справки по любой команде:
```bash
python -m src.main <команда> --help
```
Для просмотра списка всех команд с их описанием
```bash
python -m src.main --help
```

### Обработка ошибок
Все команды обрабатывают следующие типы ошибок:
- `FileNotFoundError` - файл или директория не найдены
- `PermissionError` - недостаточно прав доступа
- `IsADirectoryError` / `NotADirectoryError` - неверный тип пути
- `OSError` - общие ошибки операционной системы
- `NotAZipFileError` - файл не является ZIP архивом
- `ValueError` - невалидные параметры (для grep)
---
